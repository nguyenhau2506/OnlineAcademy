<main id="main" class="max-vh-100 vh-100">
    <div
            class="d-flex align-items-center justify-content-center h-100"
    >
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6 col-md-6">
                    <div class="card px-5 py-4">
                        <div class="text-center mb-3">
                            <img src="/public/images/user_avatar.png" width="64" height="64" alt="Avatar"
                                 class="rounded-circle mb-3">
                            <h3>Change password</h3>
                        </div>
                        {{#if result}}
                            <div class="alert alert-{{result.type}} text-center mb-3" role="alert">
                                {{result.msg}}
                            </div>
                        {{/if}}
                        <form method="POST" action="/student/change-password">
                            <div class="row mb-3">
                                <label
                                        for="oldPass"
                                        class="col-md-5 col-lg-4 col-form-label"
                                >Old password</label>
                                <div class="col-md-7 col-lg-8">
                                    <input
                                            name="oldPass"
                                            type="password"
                                            class="form-control"
                                            id="oldPass"
                                            minlength="6"
                                            maxlength="24"
                                            value=''
                                            required
                                    />
                                </div>
                            </div>

                            <div class="row mb-3">
                                <label
                                        for="newPass"
                                        class="col-md-5 col-lg-4 col-form-label"
                                >
                                    New password
                                </label>
                                <div class="col-md-7 col-lg-8">
                                    <input
                                            name="newPass"
                                            type="password"
                                            class="form-control"
                                            id="newPass"
                                            minlength="6"
                                            maxlength="24"
                                            value=''
                                            required
                                    />
                                </div>
                            </div>
                            <div class="row mb-3">
                                <label
                                        for="confirmNewPass"
                                        class="col-md-5 col-lg-4 col-form-label"
                                >
                                    Confirm new password
                                </label>
                                <div class="col-md-7 col-lg-8">
                                    <input
                                            name="confirmNewPass"
                                            type="password"
                                            class="form-control"
                                            id="confirmNewPass"
                                            minlength="6"
                                            maxlength="24"
                                            value=''
                                            required
                                            oninput="this.setCustomValidity('')"
                                    />
                                </div>
                            </div>

                            <div class="text-center">
                                <button
                                        type="submit"
                                        class="btn btn-primary"
                                >
                                    Change password
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

{{# section 'js'}}
    <script>
        const confirmPass = $('#confirmNewPass');
        const newPass = $('#newPass');

        const changePassForm = $("form[action='/student/change-password']");

        changePassForm.on('submit', (e) => {
            e.preventDefault();
            if (confirmPass.val() !== newPass.val()){
                confirmPass.get(0).setCustomValidity("Password doesn't not match");
                confirmPass.get(0).reportValidity();
                return false;
            }
            changePassForm.off().submit();
        })
    </script>
{{/section}}
